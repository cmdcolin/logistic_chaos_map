{"version":3,"sources":["drawCanvas.js","App.js","index.js"],"names":["drawCanvas","ctx","width","height","minR","maxR","minX","maxX","rstep","warmup","Math","pow","log","x","r","pointsDrawn","p","random","i","max","xp","y","fillRect","timeout","ms","Promise","resolve","setTimeout","initial","App","useState","draw","setDraw","mouseover","setMouseover","useQueryParams","withDefault","NumberParam","params","setParams","mouseDown","setMouseDown","mouseCurr","setMouseCurr","loading","setLoading","counter","setCounter","useWasm","setUseWasm","wasm","setWasm","proportion","setProportion","useEffect","a","console","error","getContext","getBoundingClientRect","fillStyle","iter","clearRect","x1","y1","x2","y2","style","margin","href","htmlFor","id","type","checked","onChange","event","target","toPrecision","onClick","position","ref","background","left","top","zIndex","onMouseDown","nativeEvent","offsetX","offsetY","onMouseMove","onMouseLeave","onMouseUp","min","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.8736dcfa.chunk.js","sourcesContent":["export default function* drawCanvas(\n  ctx,\n  width,\n  height,\n  minR,\n  maxR,\n  minX,\n  maxX\n) {\n  const rstep = (maxR - minR) / width;\n  const warmup = Math.pow(1.5, Math.log(1 / (maxR - minR))) * 1000;\n  for (let x = 0; x < width; x++) {\n    yield x + 1;\n    const r = x * rstep + minR;\n    for (let pointsDrawn = 0; pointsDrawn < 500; ) {\n      let p = Math.random();\n      for (let i = 0; i < Math.max(warmup, 10000); i++) {\n        p = r * p * (1 - p);\n      }\n      for (let i = 0; i < 500; i++) {\n        const y = height * ((p - minX) / (maxX - minX));\n        const xp = width * ((r - minR) / (maxR - minR));\n        if (y > 0 && y < height) {\n          ctx.fillRect(xp, y, 0.7, 0.7);\n          pointsDrawn++;\n        }\n        p = r * p * (1 - p);\n      }\n    }\n  }\n}\n","/* eslint-disable no-unused-vars */\nimport { useEffect, useState } from \"react\";\nimport { NumberParam, useQueryParams, withDefault } from \"use-query-params\";\nimport drawCanvas from \"./drawCanvas\";\n\nfunction timeout(ms) {\n  return new Promise((resolve) => setTimeout(resolve, ms));\n}\n\nconst initial = {\n  minX: 0,\n  maxX: 1,\n  minR: 2,\n  maxR: 4,\n};\n\nfunction App() {\n  const [draw, setDraw] = useState();\n  const [mouseover, setMouseover] = useState();\n  const [params, setParams] = useQueryParams({\n    minX: withDefault(NumberParam, 0),\n    maxX: withDefault(NumberParam, 1),\n    minR: withDefault(NumberParam, 2),\n    maxR: withDefault(NumberParam, 4),\n  });\n  const [mouseDown, setMouseDown] = useState();\n  const [mouseCurr, setMouseCurr] = useState();\n  const [loading, setLoading] = useState(true);\n  const [counter, setCounter] = useState();\n  const [useWasm, setUseWasm] = useState(false);\n  const [wasm, setWasm] = useState();\n  const [proportion, setProportion] = useState(0);\n\n  useEffect(() => {\n    (async () => {\n      try {\n        const wasm = await import(\"logistic_map_wasm\");\n        setWasm(wasm);\n      } catch (e) {\n        console.error(e);\n      }\n    })();\n  }, []);\n\n  useEffect(() => {\n    (async () => {\n      if (wasm) {\n        const { minX, maxX, minR, maxR } = params;\n        if (!draw) {\n          return;\n        }\n        const ctx = draw.getContext(\"2d\");\n        if (!ctx) {\n          return;\n        }\n        const { width, height } = draw.getBoundingClientRect();\n        draw.width = width;\n        draw.height = height;\n\n        setLoading(true);\n        ctx.fillStyle = \"white\";\n        ctx.fillRect(0, 0, width, height);\n        ctx.fillStyle = \"rgba(0,0,0,0.4)\";\n        if (useWasm) {\n          wasm.draw(ctx, width, height, minR, maxR, minX, maxX);\n        } else {\n          for (const iter of drawCanvas(\n            ctx,\n            width,\n            height,\n            minR,\n            maxR,\n            minX,\n            maxX\n          )) {\n            setProportion(iter / width);\n            await timeout(1);\n          }\n        }\n        setLoading(false);\n        setProportion(0);\n      }\n    })();\n  }, [params, draw, wasm, useWasm]);\n\n  useEffect(() => {\n    if (!mouseover) {\n      return;\n    }\n    const ctx = mouseover.getContext(\"2d\");\n    if (!ctx) {\n      return;\n    }\n    const { width, height } = mouseover.getBoundingClientRect();\n    mouseover.width = width;\n    mouseover.height = height;\n    if (mouseDown) {\n      ctx.clearRect(0, 0, width, height);\n      const [x1, y1] = mouseDown;\n      const [x2, y2] = mouseCurr;\n      ctx.fillStyle = \"rgba(255,0,0,0.3)\";\n      ctx.fillRect(x1, y1, x2 - x1, y2 - y1);\n    }\n  }, [mouseDown, mouseCurr, mouseover]);\n  const { minR, maxR, minX, maxX } = params;\n\n  return (\n    <div style={{ margin: 20 }}>\n      <h1>\n        <a href=\"https://github.com/cmdcolin/logistic_chaos_map\">\n          f(x)=rx(x-1)\n        </a>\n      </h1>\n      <p>\n        The function above is iterated for values of r between [2,4] and x\n        between [0,1] and points where it lands after 1000 initial warm up\n        iterations are plotted. Click and drag a region to zoom in.\n      </p>\n      <label htmlFor=\"wasm\">Draw with WASM</label>\n      <input\n        id=\"wasm\"\n        type=\"checkbox\"\n        checked={useWasm}\n        onChange={(event) => setUseWasm(event.target.checked)}\n      />\n      <p>\n        Current params: r=[{minR},{maxR}] x=[{minX},{maxX}]\n      </p>\n      <p>{loading ? `Loading...${proportion.toPrecision(3)}` : null}</p>\n      <button\n        onClick={() => {\n          setParams(initial);\n          setCounter(counter + 1);\n          setLoading(true);\n        }}\n      >\n        Reset\n      </button>\n      <div style={{ position: \"relative\" }}>\n        <canvas\n          ref={(ref) => setDraw(ref)}\n          style={{\n            background: \"white\",\n            width: \"100%\",\n            height: \"100vh\",\n            position: \"absolute\",\n            left: 0,\n            top: 0,\n          }}\n        />\n        <canvas\n          style={{\n            position: \"absolute\",\n            left: 0,\n            top: 0,\n            width: \"100%\",\n            height: \"100vh\",\n            zIndex: 1000,\n          }}\n          ref={(ref) => setMouseover(ref)}\n          onMouseDown={(event) => {\n            const { offsetX: x, offsetY: y } = event.nativeEvent;\n            setMouseDown([x, y]);\n            setMouseCurr([x, y]);\n          }}\n          onMouseMove={(event) => {\n            const { offsetX: x, offsetY: y } = event.nativeEvent;\n            if (mouseDown) {\n              setMouseCurr([x, y]);\n            }\n          }}\n          onMouseLeave={() => {\n            setMouseDown();\n            setMouseCurr();\n          }}\n          onMouseUp={() => {\n            const x1 = Math.min(mouseDown[0], mouseCurr[0]);\n            const x2 = Math.max(mouseDown[0], mouseCurr[0]);\n            const y1 = Math.min(mouseDown[1], mouseCurr[1]);\n            const y2 = Math.max(mouseDown[1], mouseCurr[1]);\n            const { maxR, minR, maxX, minX } = params;\n            const { width, height } = mouseover.getBoundingClientRect();\n\n            setParams({\n              minR: ((maxR - minR) * x1) / width + minR,\n              maxR: ((maxR - minR) * x2) / width + minR,\n              minX: ((maxX - minX) * y1) / height + minX,\n              maxX: ((maxX - minX) * y2) / height + minX,\n            });\n            setCounter(counter + 1);\n            setMouseDown();\n            setMouseCurr();\n            setLoading(true);\n          }}\n        />\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\n\nimport { QueryParamProvider } from \"use-query-params\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <QueryParamProvider>\n      <App />\n    </QueryParamProvider>\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}