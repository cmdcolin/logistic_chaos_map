<html>
  <head>
    <title>Logistic map visualization</title>
  </head>
  <body style="background: grey">
    <h1>f(x) = rx(1-x)</h1>
    <p>
      The function above is iterated for values of r between [2,4] and x between
      [0,1] and points where it lands after 100 initial warm up iterations are
      plotted
    </p>
    <div style="margin: 5px; background: white">
      <canvas id="canvas" style="width: 100%; height: 100%"> </canvas>
    </div>
    <script>
      let ctx;
      let w;
      let h;
      let minX = 0;
      let maxY = 1;
      let minR = 2;
      let maxR = 4;
      function draw(minX = 0, maxX = 1, minR = 2, maxR = 4) {
        for (let r = minR; r < maxR; r += 0.001) {
          let x = 0;

          for (let p = minX; p < maxX; p += 0.05) {
            let x = p;
            for (let i = 0; i < 100; i++) {
              x = r * x * (1 - x);
            }
            for (let i = 0; i < 100; i++) {
              ctx.fillRect(w * ((r - minR) / (maxR - minR)), x * h, 0.5, 0.5);
              x = r * x * (1 - x);
            }
          }
        }
      }
      requestIdleCallback(() => {
        const canvas = document.getElementById("canvas");
        const { width, height } = canvas.getBoundingClientRect();
        ctx = canvas.getContext("2d");
        w = width;
        h = height;
        canvas.width = width;
        canvas.height = height;
        ctx.fillStyle = "rgba(0,0,0,0.3)";
        draw();
        let currX1, currY1, currX2, currY2;
        canvas.addEventListener("click", (event) => {
          const { offsetX, offsetY } = event;
          currX1 = offsetX;
          currX2 = offsetX;
          currY1 = offsetY;
          currY2 = offsetY;
          canvas.addEventListener("mouseup", (event) => {
            const { offsetX, offsetY } = event;
            minR = draw(minX, maxX, minR, maxR);
          });
        });
      });
    </script>
  </body>
</html>
